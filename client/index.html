<!DOCTYPE html>
<html ng-app="project_app">
<head>
	<title>MotionDreams</title>
		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular.min.js"></script>
	  	<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.5/angular-route.js"></script>
	  	<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-local-storage/0.2.2/angular-local-storage.js"></script>
	  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

	  	<script type="text/javascript">

			var myApp = angular.module('project_app', ['ngRoute', 'LocalStorageModule']);
			myApp.config(function($routeProvider)
			  {
			   $routeProvider
			 	  .when('/home',{
			          templateUrl: './../partials/home.html'
			      })
			      .when('/login',{
			          templateUrl: './../partials/login.html'
			      })
			      .when('/success',{
			          templateUrl: './../partials/success.html'
			      })
			      .when('/all_projects',{
			          templateUrl: './../partials/all_projects.html'
			      })
			      .when('/contact_us',{
			          templateUrl: './../partials/contact_us.html'
			      })
			      .when('/about_us',{
			          templateUrl: './../partials/about_us.html'
			      })
			      .when('/faq',{
			          templateUrl: './../partials/faq.html'
			      })
			      .when('/security',{
			          templateUrl: './../partials/security.html'
			      })
			      .when('/raise_funds',{
			          templateUrl: './../partials/raise_funds.html'
			      })
			      .when('/explore',{
			          templateUrl: './../partials/explore.html'
			      })
			      .when('/what_is_fundhub',{
			          templateUrl: './../partials/what_is_fundhub.html'
			      })
			      .when('/comapany/:companyId',{
			          templateUrl: './../partials/comapany.html',
			          controller: 'CompaniesController'
			      })
			      .otherwise({
			        templateUrl: './../partials/home.html'
			      });
			    })

		myApp.factory('UsersFactory', function($http, localStorageService) {
	        var factory = {};
	        var users = [];

	        factory.get_one_company = function(id, callback) {
	            $http.get('/show_a_company/' + id).success(function(output) {
	            company = output;
	            callback(company);
	            });
	        },

	        factory.create = function(info, callback) {

	            $http.post('/create', info).success(function() {
	            	users.push({
	         					});    
	            	callback(users);
	          	});
	         factory.getPopularProjects = function(callback) {
	            $http.get('/getPopularProjects').success(function(output) {
		            users = output;
		            callback(users);
	            });
        	}

        	factory.getRecentlyFunded = function(callback) {
	            $http.get('/getRecentlyFunded').success(function(output) {
		            users = output;
		            callback(users);
	            });
        	}

	     return factory
        })

        myApp.controller('UsersController', function($scope, UsersFactory) {
	        UsersFactory.getPopularProjects(function(data) {
	        $scope.users = data;
	        })

	        UsersFactory.getRecentlyFunded(function(data) {
	        $scope.users = data;
	        })
    	});

        myApp.controller('CompaniesController', function($scope, $routeParams, UsersFactory) {
        	
        	var id = $routeParams.id;
	        UsersFactory.getUsers(function(data) {
	        $scope.users = data;
	        })

	        UsersFactory.get_one_company(id, function(data) {
	        $scope.companies = data;
	        })
    	});	

        myApp.controller('ProjectsController', function($scope, UsersFactory) {

			UsersFactory.create($scope.newCompany, function() {
					            	UsersFactory.getCompanies(function(data) {
					            		$scope.companies = data;
					           		 });
					          	});
			$scope.newCompany = {};
    	});	

	  	</script>
</head>
<body>
	<div ng-view=""></div>
</body>
</html>